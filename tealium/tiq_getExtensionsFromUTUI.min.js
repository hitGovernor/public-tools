let extensions=utui.data.customizations,delimiter="~~",csvTitles=["id","title","type","loadOrder","status","scope","advExecOption","conditions"].join(delimiter),output=[csvTitles],getConditions=function(payload){let conditions=[],retval="";for(key in payload)/^[0-9]{18}(_[0-9]{18})?_(filter(type)?|source)$/.test(key)&&conditions.push([key,payload[key]]);conditions.sort((function(a,b){return a[0]<b[0]?-1:a[0]>b[0]?1:0}));let objConditions={};for(var i=0;i<conditions.length;i++)objConditions[conditions[i][0]]=conditions[i][1];for(key in objConditions)retval+=key+"="+objConditions[key]+"^|^";return retval=retval.replace(/(\^\|\^)$/,""),retval},getLastProdUpdateInfo=function(payload){let lastProdPubDate=payload.publish_revisions.svr_save_timestamps.prod,retval={};return retval.lastProdPubUser=utui.data.publish_history[lastProdPubDate][lastProdPubDate].operator||"",retval.lastProdPubVersion=utui.data.publish_history[lastProdPubDate][lastProdPubDate].title||"",retval},advExecOptionLookup={alr:"After Load Rules - Run Always",alr_ro:"After Load Rules - Run Once",blr:"Before Load Rules - Run Always",blr_ro:"Before Load Rules - Run Once",end:"After Tag Extensions - Run Always",end_ro:"After Tag Extensions - Run Once"};for(extension in extensions){let item=utui.automator.getExtensionById(extension),conditions=getConditions(item),lastProdUpdateInfo=getLastProdUpdateInfo(item);console.log(item),output.push([item._id,item.title,item.extType,item.sort+1,item.status,item.scope,advExecOptionLookup[item.advExecOption]+" ("+item.advExecOption+")"||item.advExecOption,conditions||""].join(delimiter))}let forCsv="";output.forEach((function(item){forCsv+=""!==forCsv?"\n"+item:item})),console.log(forCsv);